<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>51Degrees IP Intelligence .NET: OnPremise/Compare-Console/Program.cs</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="examplegrabber.js"></script>
<script type="text/javascript" src="testedversionsgrabber.js"></script>
<script type="text/javascript" src="search51.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="docs-main.min.css" rel="stylesheet" type="text/css" />
</head>
<body class="l-docs-index p-doxygen">
<div class="l-index__content">
<!--div id="top"--><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea" class="g-header g-header--docs">
  <h1 class="c-brand">
  <a id="projectlogo" href="/documentation/4.5/index.html" class="c-brand__link"><img class="c-brand__image" alt="Logo" src="logo-51Degrees-Docs.png" style="width:172px;"/></a>
  <span class="c-tagline">51Degrees IP Intelligence .NET
   &#160;<span id="projectnumber">4.5</span>
  </span>
  </h1>
  <div id="projectalign" style="padding-left: 0.5em;">
   <div id="projectbrief">IP intelligence services for 51Degrees Pipeline</div>
  </div>
  <div id="main-nav"></div>
  <section class="g-search">
    <div class="c-search is-openable" id="searchOpenable">
    <form class="c-search__form">
      <div class="b-form-group b-form-group--with-icon">
        <label for="inputSearch" class="b-text--hidden">Search</label>
        <img src="icon-search.svg" class="b-icon" alt="Search" />
        <input type="text" class="c-search__input" id="inputSearch" onkeyup="javascript:onSearch(this,event.keyCode)" placeholder="Search" aria-label="Search">
      </div>
    </form>
    <div class="c-search__content" id="searchContent">
    </div>
  </div> 
  </section>
</div>
<!-- end header part -->
<main class="g-main">
<!-- Generated by Doxygen 1.8.15 -->
<!-- top -->
	<div class="g-docs__sidenav">																														         <nav id="nav-tree-contents" class="c-sidenav">																														     <h4 class="c-sidenav__heading">Documentation</h4>																									         <div id="nav-sync" class="sync"></div>
  <ul class="c-sidenav__list">																														     </ul>																																				   </nav>    </div><script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_on_premise_2_compare-_console_2_program_8cs-example.html','');});
/* @license-end */
</script>
<div id="doc-content" class="g-docs__content">
<div class="g-docs__header">
<h2 class="g-docs__page-title">OnPremise/Compare-Console/Program.cs</h2></div><!--header-->
<div class="g-docs__inner">
<div class="g-docs__primary" id="primary">
<p>This example takes in a CSV file containing 'known and true' IP-Location records (IP addresses with associated latitude and longitudes).In this context, 'known and true' refers to real-world data the user has collected that is considered accurate and trustworthy.</p>
<p>These records are then used for comparison against an IP Intelligence service that can return latitude, longitude and area information for a given IP address. This can be useful for understanding how the results of an IP to location service compare to real-world information, especially when evaluating different solutions.</p>
<p>The example will ingest the following fields from a CSV file.</p>
<p>Date Time IP address Address Family (optional) Latitude Longitude Continent (optional) Country (optional)</p>
<p>See the <code>Truth</code> class for all fields and descriptions.</p>
<p>The IP Intelligence service is used to obtain the latitude and longitude from the IP address. The distance in kilometers is then calculate along with the confidence if available, the total geographic area covered by the area returned, and an indicator as to if the provided latitude and longitude is within the area returned.</p>
<p>Output fields are defined in the <code>Result</code> class and include.</p>
<p>Latitude Longitude Found Geometries SquareKms DistanceKms</p>
<p>The output CSV file contains the input truth and the result fields for easy evaluation.</p>
<p>This example is available in full on <a href="https://github.com/51Degrees/ip-intelligence-dotnet-examples/blob/master/Examples/OnPremise/Compare-Console/Program.cs">GitHub</a>.</p>
<p>This example requires an enterprise IP Intelligence data file (.ipi). To obtain an enterprise data file for testing, please <a href="https://51degrees.com/contact-us">contact us</a>.</p>
<p>Required NuGet Dependencies:</p><ul>
<li><a href="https://www.nuget.org/packages/FiftyOne.IpIntelligence/">FiftyOne.IpIntelligence</a></li>
<li><a href="https://www.nuget.org/packages/Microsoft.Extensions.Logging.Console/">Microsoft.Extensions.Logging.Console</a> </li>
</ul>
<div class="c-code__block c-code__block--outline"><div class="c-code__line"><span class="c-code__comment">/* *********************************************************************</span></div><div class="c-code__line"><span class="c-code__comment"> * This Original Work is copyright of 51 Degrees Mobile Experts Limited.</span></div><div class="c-code__line"><span class="c-code__comment"> * Copyright 2025 51 Degrees Mobile Experts Limited, Davidson House,</span></div><div class="c-code__line"><span class="c-code__comment"> * Forbury Square, Reading, Berkshire, United Kingdom RG1 3EU.</span></div><div class="c-code__line"><span class="c-code__comment"> *</span></div><div class="c-code__line"><span class="c-code__comment"> * This Original Work is licensed under the European Union Public Licence</span></div><div class="c-code__line"><span class="c-code__comment"> * (EUPL) v.1.2 and is subject to its terms as set out below.</span></div><div class="c-code__line"><span class="c-code__comment"> *</span></div><div class="c-code__line"><span class="c-code__comment"> * If a copy of the EUPL was not distributed with this file, You can obtain</span></div><div class="c-code__line"><span class="c-code__comment"> * one at https://opensource.org/licenses/EUPL-1.2.</span></div><div class="c-code__line"><span class="c-code__comment"> *</span></div><div class="c-code__line"><span class="c-code__comment"> * The &#39;Compatible Licences&#39; set out in the Appendix to the EUPL (as may be</span></div><div class="c-code__line"><span class="c-code__comment"> * amended by the European Commission) shall be deemed incompatible for</span></div><div class="c-code__line"><span class="c-code__comment"> * the purposes of the Work and the provisions of the compatibility</span></div><div class="c-code__line"><span class="c-code__comment"> * clause in Article 5 of the EUPL shall not apply.</span></div><div class="c-code__line"><span class="c-code__comment"> *</span></div><div class="c-code__line"><span class="c-code__comment"> * If using the Work as, or as part of, a network application, by</span></div><div class="c-code__line"><span class="c-code__comment"> * including the attribution notice(s) required under Article 5 of the EUPL</span></div><div class="c-code__line"><span class="c-code__comment"> * in the end user terms of the application under an appropriate heading,</span></div><div class="c-code__line"><span class="c-code__comment"> * such notice(s) shall fulfill the requirements of that article.</span></div><div class="c-code__line"><span class="c-code__comment"> * ********************************************************************* */</span></div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">using</span> CsvHelper;</div><div class="c-code__line"><span class="c-code__keyword">using</span> CsvHelper.Configuration;</div><div class="c-code__line"><span class="c-code__keyword">using</span> CsvHelper.Configuration.Attributes;</div><div class="c-code__line"><span class="c-code__keyword">using</span> Examples.OnPremise.Areas;</div><div class="c-code__line"><span class="c-code__keyword">using</span> <a class="code" href="namespace_fifty_one.html">FiftyOne</a>.<a class="code" href="namespace_fifty_one_1_1_ip_intelligence.html">IpIntelligence</a>.<a class="code" href="namespace_fifty_one_1_1_ip_intelligence_1_1_engine.html">Engine</a>.<a class="code" href="namespace_fifty_one_1_1_ip_intelligence_1_1_engine_1_1_on_premise.html">OnPremise</a>.<a class="code" href="namespace_fifty_one_1_1_ip_intelligence_1_1_engine_1_1_on_premise_1_1_flow_elements.html">FlowElements</a>;</div><div class="c-code__line"><span class="c-code__keyword">using</span> <a class="code" href="namespace_fifty_one.html">FiftyOne</a>.Pipeline.Core.Data;</div><div class="c-code__line"><span class="c-code__keyword">using</span> <a class="code" href="namespace_fifty_one.html">FiftyOne</a>.Pipeline.Core.FlowElements;</div><div class="c-code__line"><span class="c-code__keyword">using</span> <a class="code" href="namespace_fifty_one.html">FiftyOne</a>.Pipeline.Engines;</div><div class="c-code__line"><span class="c-code__keyword">using</span> <a class="code" href="namespace_fifty_one.html">FiftyOne</a>.Pipeline.Engines.Data;</div><div class="c-code__line"><span class="c-code__keyword">using</span> GeoCoordinatePortable;</div><div class="c-code__line"><span class="c-code__keyword">using</span> Microsoft.Extensions.DependencyInjection;</div><div class="c-code__line"><span class="c-code__keyword">using</span> Microsoft.Extensions.Hosting;</div><div class="c-code__line"><span class="c-code__keyword">using</span> Microsoft.Extensions.Logging;</div><div class="c-code__line"><span class="c-code__keyword">using</span> System;</div><div class="c-code__line"><span class="c-code__keyword">using</span> System.Collections.Concurrent;</div><div class="c-code__line"><span class="c-code__keyword">using</span> System.Collections.Generic;</div><div class="c-code__line"><span class="c-code__keyword">using</span> System.Data;</div><div class="c-code__line"><span class="c-code__keyword">using</span> System.Diagnostics;</div><div class="c-code__line"><span class="c-code__keyword">using</span> System.Globalization;</div><div class="c-code__line"><span class="c-code__keyword">using</span> System.IO;</div><div class="c-code__line"><span class="c-code__keyword">using</span> System.Linq;</div><div class="c-code__line"><span class="c-code__keyword">using</span> System.Net;</div><div class="c-code__line"><span class="c-code__keyword">using</span> System.Runtime;</div><div class="c-code__line"><span class="c-code__keyword">using</span> System.Threading;</div><div class="c-code__line"><span class="c-code__keyword">using</span> System.Threading.Tasks;</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">namespace </span>FiftyOne.IpIntelligence.Examples.OnPremise.Compare;</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">public</span> <span class="c-code__keyword">class </span><a name="_a0"></a><a class="code" href="class_program.html">Program</a></div><div class="c-code__line">{</div><div class="c-code__line">    <span class="c-code__keyword">private</span> <span class="c-code__keyword">static</span> readonly TimeSpan _logBuild = TimeSpan.FromSeconds(30);</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__keyword">public</span> <span class="c-code__keyword">class </span>Truth</div><div class="c-code__line">    {</div><div class="c-code__line">        <span class="c-code__keyword">public</span> DateTime <a name="a1"></a><a class="code" href="class_program_1_1_truth.html#aefc57c961cc2640a67c6123c9ab5e797">DateTimeUtc</a> { <span class="c-code__keyword">get</span>; <span class="c-code__keyword">set</span>; }</div><div class="c-code__line"></div><div class="c-code__line">        <span class="c-code__keyword">public</span> <span class="c-code__keywordtype">double</span> <a name="a2"></a><a class="code" href="class_program_1_1_truth.html#a6ad80cf26f9638c13bb3f0412ced9932">Latitude</a> { <span class="c-code__keyword">get</span>; <span class="c-code__keyword">set</span>; }</div><div class="c-code__line"></div><div class="c-code__line">        <span class="c-code__keyword">public</span> <span class="c-code__keywordtype">double</span> <a name="a3"></a><a class="code" href="class_program_1_1_truth.html#a7e513104bdca24b919dccc454858417b">Longitude</a> { <span class="c-code__keyword">get</span>; <span class="c-code__keyword">set</span>; }</div><div class="c-code__line"></div><div class="c-code__line">        <span class="c-code__keyword">public</span> <span class="c-code__keywordtype">string</span> <a name="a4"></a><a class="code" href="class_program_1_1_truth.html#a50e9d75ca5ff8c673015d4fa55b78363">Ip</a> { <span class="c-code__keyword">get</span>; <span class="c-code__keyword">set</span>; }</div><div class="c-code__line"></div><div class="c-code__line">        <span class="c-code__keyword">public</span> <span class="c-code__keywordtype">string</span> <a name="a5"></a><a class="code" href="class_program_1_1_truth.html#a854ed92fff767e155a78d87da5c1af94">AddressFamily</a> { <span class="c-code__keyword">get</span>; <span class="c-code__keyword">set</span>; }</div><div class="c-code__line"></div><div class="c-code__line">        <span class="c-code__keyword">public</span> <span class="c-code__keywordtype">string</span> <a name="a6"></a><a class="code" href="class_program_1_1_truth.html#abbb7e5f6041ca26244a107c273e56a17">Continent</a> { <span class="c-code__keyword">get</span>; <span class="c-code__keyword">set</span>; }</div><div class="c-code__line"></div><div class="c-code__line">        <span class="c-code__keyword">public</span> <span class="c-code__keywordtype">string</span> <a name="a7"></a><a class="code" href="class_program_1_1_truth.html#a69a0e553bca4a14936c051dfead88108">Country</a> { <span class="c-code__keyword">get</span>; <span class="c-code__keyword">set</span>; }</div><div class="c-code__line">    }</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__keyword">public</span> <span class="c-code__keyword">class </span>Result</div><div class="c-code__line">    {</div><div class="c-code__line">        [Name(<span class="c-code__stringliteral">&quot;LatitudeResult&quot;</span>)]</div><div class="c-code__line">        <span class="c-code__keyword">public</span> <span class="c-code__keywordtype">double</span>? <a name="a8"></a><a class="code" href="class_program_1_1_result.html#ad2180511ef40c9484b201ec532767a3a">Latitude</a> { <span class="c-code__keyword">get</span>; <span class="c-code__keyword">set</span>; }</div><div class="c-code__line"></div><div class="c-code__line">        [Name(<span class="c-code__stringliteral">&quot;LongitudeResult&quot;</span>)]</div><div class="c-code__line">        <span class="c-code__keyword">public</span> <span class="c-code__keywordtype">double</span>? <a name="a9"></a><a class="code" href="class_program_1_1_result.html#a1293a125f2e703757eb68786dd3f0c8b">Longitude</a> { <span class="c-code__keyword">get</span>; <span class="c-code__keyword">set</span>; }</div><div class="c-code__line"></div><div class="c-code__line">        <span class="c-code__keyword">public</span> <span class="c-code__keywordtype">string</span> <a name="a10"></a><a class="code" href="class_program_1_1_result.html#a73e1bf237fe3f70aa5e43e062596baa5">Confidence</a> { <span class="c-code__keyword">get</span>; <span class="c-code__keyword">set</span>; }</div><div class="c-code__line"></div><div class="c-code__line">        <span class="c-code__keyword">public</span> <span class="c-code__keywordtype">double</span> <a name="a11"></a><a class="code" href="class_program_1_1_result.html#ae18a4130a454b5c5a3aef4432c8da21d">DistanceKms</a> { <span class="c-code__keyword">get</span>; <span class="c-code__keyword">set</span>; }</div><div class="c-code__line"></div><div class="c-code__line">        <span class="c-code__keyword">public</span> <span class="c-code__keywordtype">int</span> <a name="a12"></a><a class="code" href="class_program_1_1_result.html#a6a59c7ae158d8b2cc8d74d2491566c7c">SquareKms</a> { <span class="c-code__keyword">get</span>; <span class="c-code__keyword">set</span>; }</div><div class="c-code__line"></div><div class="c-code__line">        <span class="c-code__keyword">public</span> <span class="c-code__keywordtype">int</span> <a name="a13"></a><a class="code" href="class_program_1_1_result.html#a5a38cfe4da4500d34188e0ef6f763548">Geometries</a> { <span class="c-code__keyword">get</span>; <span class="c-code__keyword">set</span>; }</div><div class="c-code__line"></div><div class="c-code__line">        <span class="c-code__keyword">public</span> <span class="c-code__keywordtype">bool</span> <a name="a14"></a><a class="code" href="class_program_1_1_result.html#a45cd2204fa0335cf51ed553fc4616633">Contains</a> { <span class="c-code__keyword">get</span>; <span class="c-code__keyword">set</span>; }</div><div class="c-code__line">    }</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__keyword">public</span> <span class="c-code__keyword">class </span><a name="a15"></a><a class="code" href="class_program.html#adf4fe232dbc7930c5ff8d4966b2c48a0">Output</a>(Truth truth, Result result)</div><div class="c-code__line">    {</div><div class="c-code__line">        <span class="c-code__keyword">public</span> Truth Truth =&gt; truth;</div><div class="c-code__line">        <span class="c-code__keyword">public</span> Result Result =&gt; result;</div><div class="c-code__line">    }</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__keyword">public</span> <span class="c-code__keyword">class </span>Consumer</div><div class="c-code__line">    {</div><div class="c-code__line">        <span class="c-code__keyword">public</span> Task&lt;IReadOnlyList&lt;Output&gt;&gt; <a name="a16"></a><a class="code" href="class_program_1_1_consumer.html#aa4e47e2256d8acf624354e365c21c1c2">Task</a>;</div><div class="c-code__line"></div><div class="c-code__line">        <span class="c-code__keyword">public</span> <span class="c-code__keywordtype">int</span> <a name="a17"></a><a class="code" href="class_program_1_1_consumer.html#ae2b85450219c17ff8d00215dab84c01c">Count</a>;</div><div class="c-code__line">    }</div><div class="c-code__line">    </div><div class="c-code__line">    <span class="c-code__keyword">public</span> <span class="c-code__keyword">class </span>Configuration</div><div class="c-code__line">    {</div><div class="c-code__line">        <span class="c-code__keyword">public</span> <span class="c-code__keywordtype">string</span> <a name="a18"></a><a class="code" href="class_program_1_1_configuration.html#a615a45e75f8ab706ccf67a5e7e7fe8bc">DataFile</a>;</div><div class="c-code__line"></div><div class="c-code__line">        <span class="c-code__keyword">public</span> <span class="c-code__keywordtype">string</span> <a name="a19"></a><a class="code" href="class_program_1_1_configuration.html#a65a6bd967322784b53c97b163c6eea98">CsvTruthFile</a>;</div><div class="c-code__line"></div><div class="c-code__line">        <span class="c-code__keyword">public</span> StreamWriter <a name="a20"></a><a class="code" href="class_program_1_1_configuration.html#a847167efb959f576e62709e9315405b6">Output</a>;</div><div class="c-code__line">                </div><div class="c-code__line">        <span class="c-code__keyword">public</span> ILoggerFactory <a name="a21"></a><a class="code" href="class_program_1_1_configuration.html#a47de969dc8063ea3e53b1d84d87be5b0">LoggerFactory</a>;</div><div class="c-code__line">    }</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__keyword">public</span> sealed <span class="c-code__keyword">class </span><a name="a22"></a><a class="code" href="class_program.html#a898dc758806b6d5937f2fd6382eebd91">Worker</a>(</div><div class="c-code__line">        IHostApplicationLifetime hostApplicationLifetime,</div><div class="c-code__line">        Configuration configuration) </div><div class="c-code__line">        : BackgroundService</div><div class="c-code__line">    {</div><div class="c-code__line">        <span class="c-code__keyword">protected</span> <span class="c-code__keyword">override</span> async Task ExecuteAsync(</div><div class="c-code__line">            CancellationToken stoppingToken)</div><div class="c-code__line">        {</div><div class="c-code__line">            await Example.Run(</div><div class="c-code__line">                configuration.DataFile,</div><div class="c-code__line">                configuration.CsvTruthFile,</div><div class="c-code__line">                configuration.Output,</div><div class="c-code__line">                configuration.LoggerFactory,</div><div class="c-code__line">                stoppingToken);</div><div class="c-code__line">            hostApplicationLifetime.StopApplication();</div><div class="c-code__line">        }</div><div class="c-code__line">    }</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__keyword">public</span> <span class="c-code__keyword">class </span>Example : ExampleBase</div><div class="c-code__line">    {</div><div class="c-code__line">        <span class="c-code__keyword">public</span> <span class="c-code__keyword">static</span> async Task Run(</div><div class="c-code__line">            <span class="c-code__keywordtype">string</span> dataFile, </div><div class="c-code__line">            <span class="c-code__keywordtype">string</span> csvTruthFile,</div><div class="c-code__line">            TextWriter output,</div><div class="c-code__line">            ILoggerFactory loggerFactory,</div><div class="c-code__line">            CancellationToken stoppingToken,</div><div class="c-code__line">            ILogger logger = <span class="c-code__keyword">null</span>)</div><div class="c-code__line">        {</div><div class="c-code__line">            logger ??= loggerFactory.CreateLogger&lt;Example&gt;();</div><div class="c-code__line"></div><div class="c-code__line">            <span class="c-code__comment">// Ensure that batch latency mode is always enabled.</span></div><div class="c-code__line">            GCSettings.LatencyMode = GCLatencyMode.Batch;</div><div class="c-code__line"></div><div class="c-code__line">            <span class="c-code__comment">// Build a new on-premise IP Intelligence engine with the max</span></div><div class="c-code__line">            <span class="c-code__comment">// performance profile.</span></div><div class="c-code__line">            <span class="c-code__keyword">using</span> var ipiEngine = <span class="c-code__keyword">new</span> IpiOnPremiseEngineBuilder(loggerFactory)</div><div class="c-code__line">                <span class="c-code__comment">// We use the max performance profile for optimal detection</span></div><div class="c-code__line">                <span class="c-code__comment">// speed in this example. See the documentation for more detail</span></div><div class="c-code__line">                <span class="c-code__comment">// on this and other configuration options.</span></div><div class="c-code__line">                <span class="c-code__comment">// https://51degrees.com/documentation/_features__automatic_datafile_updates.html</span></div><div class="c-code__line">                .SetPerformanceProfile(PerformanceProfiles.MaxPerformance)</div><div class="c-code__line">                <span class="c-code__comment">// inhibit auto-update of the data file for this test</span></div><div class="c-code__line">                .SetAutoUpdate(<span class="c-code__keyword">false</span>)</div><div class="c-code__line">                .SetDataFileSystemWatcher(<span class="c-code__keyword">false</span>)</div><div class="c-code__line">                .SetDataUpdateOnStartup(<span class="c-code__keyword">false</span>)</div><div class="c-code__line">                <span class="c-code__comment">// Set to only return from processing the properties needed.</span></div><div class="c-code__line">                .SetProperty(<span class="c-code__stringliteral">&quot;Latitude&quot;</span>)</div><div class="c-code__line">                .SetProperty(<span class="c-code__stringliteral">&quot;Longitude&quot;</span>)</div><div class="c-code__line">                .SetProperty(<span class="c-code__stringliteral">&quot;LocationConfidence&quot;</span>)</div><div class="c-code__line">                .SetProperty(<span class="c-code__stringliteral">&quot;Areas&quot;</span>)</div><div class="c-code__line">                <span class="c-code__comment">// Optimize for the expected parallel workload.</span></div><div class="c-code__line">                .SetConcurrency((ushort)Environment.ProcessorCount)</div><div class="c-code__line">                .Build(dataFile, <span class="c-code__keyword">false</span>);</div><div class="c-code__line"></div><div class="c-code__line">            <span class="c-code__comment">// Build a pipeline to consumer the IP intelligence engine. Needed</span></div><div class="c-code__line">            <span class="c-code__comment">// so that flowdata can be used to pass evidence in and get</span></div><div class="c-code__line">            <span class="c-code__comment">// results.</span></div><div class="c-code__line">            <span class="c-code__keyword">using</span> var pipeline = <span class="c-code__keyword">new</span> PipelineBuilder(loggerFactory)</div><div class="c-code__line">                .AddFlowElement(ipiEngine)</div><div class="c-code__line">                .SetAutoDisposeElements(<span class="c-code__keyword">false</span>)</div><div class="c-code__line">                .Build();</div><div class="c-code__line"></div><div class="c-code__line">            <span class="c-code__comment">// Create a reader for the source of truth.</span></div><div class="c-code__line">            <span class="c-code__keyword">using</span> var reader = File.OpenText(csvTruthFile);</div><div class="c-code__line">            var config = CsvConfiguration.FromAttributes&lt;Truth&gt;(</div><div class="c-code__line">                CultureInfo.InvariantCulture);</div><div class="c-code__line">            config.MissingFieldFound = <span class="c-code__keyword">null</span>;</div><div class="c-code__line">            <span class="c-code__keyword">using</span> var source = <span class="c-code__keyword">new</span> CsvReader(reader, config);</div><div class="c-code__line"></div><div class="c-code__line">            <span class="c-code__comment">// Create a collection of truths to ensure that there are records</span></div><div class="c-code__line">            <span class="c-code__comment">// always available to the consumer.</span></div><div class="c-code__line">            var truth = <span class="c-code__keyword">new</span> BlockingCollection&lt;Truth&gt;(</div><div class="c-code__line">                Environment.ProcessorCount);</div><div class="c-code__line"></div><div class="c-code__line">            <span class="c-code__comment">// Create consumers that are used to add the result to the truth.</span></div><div class="c-code__line">            <span class="c-code__comment">// These run in parallel to ensure best performance as the IPI and </span></div><div class="c-code__line">            <span class="c-code__comment">// area calculations can be time consuming compared to reading new</span></div><div class="c-code__line">            <span class="c-code__comment">// truth records.</span></div><div class="c-code__line">            var consumers = CreateConsumers(</div><div class="c-code__line">                pipeline,</div><div class="c-code__line">                truth,</div><div class="c-code__line">                stoppingToken);</div><div class="c-code__line">            logger.LogInformation(</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;Created &#39;{0}&#39; consumer processors&quot;</span>,</div><div class="c-code__line">                consumers.Length);</div><div class="c-code__line"></div><div class="c-code__line">            <span class="c-code__comment">// Use the main thread as the producer adding truths for the</span></div><div class="c-code__line">            <span class="c-code__comment">// consumers to process.</span></div><div class="c-code__line">            AddTruth(logger, source, truth, consumers, stoppingToken);</div><div class="c-code__line"></div><div class="c-code__line">            <span class="c-code__comment">// Create the write for the destination output.</span></div><div class="c-code__line">            <span class="c-code__keyword">using</span> var writer = <span class="c-code__keyword">new</span> CsvWriter(</div><div class="c-code__line">                output,</div><div class="c-code__line">                <span class="c-code__keyword">new</span> CsvConfiguration(CultureInfo.InvariantCulture)</div><div class="c-code__line">                {</div><div class="c-code__line">                    Delimiter = <span class="c-code__stringliteral">&quot;,&quot;</span></div><div class="c-code__line">                });</div><div class="c-code__line"></div><div class="c-code__line">            <span class="c-code__comment">// Wait for the consumer to stop and then write out the records it</span></div><div class="c-code__line">            <span class="c-code__comment">// generated.</span></div><div class="c-code__line">            <span class="c-code__keywordflow">foreach</span> (var consumer <span class="c-code__keywordflow">in</span> consumers)</div><div class="c-code__line">            {</div><div class="c-code__line">                await consumer.Task;</div><div class="c-code__line">                logger.LogInformation(</div><div class="c-code__line">                    <span class="c-code__stringliteral">&quot;Finished consumer &#39;{0}&#39;&quot;</span>, </div><div class="c-code__line">                    consumer.Task.Id);</div><div class="c-code__line">                writer.WriteRecords(consumer.Task.Result);</div><div class="c-code__line">            }</div><div class="c-code__line"></div><div class="c-code__line">            <span class="c-code__comment">// Finally check the data file used for consistency with the other</span></div><div class="c-code__line">            <span class="c-code__comment">// examples.</span></div><div class="c-code__line">            ExampleUtils.CheckDataFile(</div><div class="c-code__line">                ipiEngine,</div><div class="c-code__line">                loggerFactory.CreateLogger&lt;<a class="code" href="class_program.html">Program</a>&gt;());</div><div class="c-code__line">        }</div><div class="c-code__line"></div><div class="c-code__line">        <span class="c-code__keyword">private</span> <span class="c-code__keyword">static</span> Consumer[] CreateConsumers(</div><div class="c-code__line">            IPipeline pipeline,</div><div class="c-code__line">            BlockingCollection&lt;Truth&gt; truth,</div><div class="c-code__line">            CancellationToken stoppingToken)</div><div class="c-code__line">        {</div><div class="c-code__line">            <span class="c-code__keywordflow">return</span> Enumerable.Range(</div><div class="c-code__line">                0,</div><div class="c-code__line">                Environment.ProcessorCount).Select(_ =&gt;</div><div class="c-code__line">                {</div><div class="c-code__line">                    var consumer = <span class="c-code__keyword">new</span> Consumer();</div><div class="c-code__line">                    consumer.Task = Task.Factory.StartNew(() =&gt;</div><div class="c-code__line">                        ProcessTruth(</div><div class="c-code__line">                            pipeline,</div><div class="c-code__line">                            truth,</div><div class="c-code__line">                            consumer,</div><div class="c-code__line">                            stoppingToken),</div><div class="c-code__line">                        TaskCreationOptions.LongRunning);</div><div class="c-code__line">                    <span class="c-code__keywordflow">return</span> consumer;</div><div class="c-code__line">                }).ToArray();</div><div class="c-code__line">        }</div><div class="c-code__line"></div><div class="c-code__line">        <span class="c-code__keyword">private</span> <span class="c-code__keyword">static</span> <span class="c-code__keywordtype">void</span> AddTruth(</div><div class="c-code__line">            ILogger logger,</div><div class="c-code__line">            CsvReader source,</div><div class="c-code__line">            BlockingCollection&lt;Truth&gt; truth,</div><div class="c-code__line">            Consumer[] consumers, </div><div class="c-code__line">            CancellationToken stoppingToken)</div><div class="c-code__line">        {</div><div class="c-code__line">            var process = Process.GetCurrentProcess();</div><div class="c-code__line">            var lastLog = DateTime.UtcNow;</div><div class="c-code__line">            var nextLog = lastLog.Add(_logBuild);</div><div class="c-code__line">            var lastProcessorTime = process.TotalProcessorTime;</div><div class="c-code__line">            var ips = <span class="c-code__keyword">new</span> HashSet&lt;string&gt;();</div><div class="c-code__line">            <span class="c-code__keywordflow">foreach</span> (var item <span class="c-code__keywordflow">in</span> source.GetRecords&lt;Truth&gt;().TakeWhile(</div><div class="c-code__line">                _ =&gt; stoppingToken.IsCancellationRequested == <span class="c-code__keyword">false</span>))</div><div class="c-code__line">            {</div><div class="c-code__line">                <span class="c-code__keywordflow">try</span></div><div class="c-code__line">                {</div><div class="c-code__line">                    <span class="c-code__keywordflow">if</span> (ips.Contains(item.Ip) == <span class="c-code__keyword">false</span>)</div><div class="c-code__line">                    {</div><div class="c-code__line">                        truth.TryAdd(item, -1, stoppingToken);</div><div class="c-code__line">                        ips.Add(item.Ip);</div><div class="c-code__line">                    }</div><div class="c-code__line">                    LogProgress(</div><div class="c-code__line">                        logger, </div><div class="c-code__line">                        truth, </div><div class="c-code__line">                        consumers, </div><div class="c-code__line">                        process,</div><div class="c-code__line">                        ips.Count, </div><div class="c-code__line">                        ref lastLog, </div><div class="c-code__line">                        ref nextLog, </div><div class="c-code__line">                        ref lastProcessorTime, </div><div class="c-code__line">                        item);</div><div class="c-code__line">                }</div><div class="c-code__line">                <span class="c-code__keywordflow">catch</span> (OperationCanceledException)</div><div class="c-code__line">                {</div><div class="c-code__line">                    <span class="c-code__comment">// Do nothing and exit as if the truths had been fully</span></div><div class="c-code__line">                    <span class="c-code__comment">// consumed.</span></div><div class="c-code__line">                }</div><div class="c-code__line">            }</div><div class="c-code__line">            truth.CompleteAdding();</div><div class="c-code__line">            logger.LogInformation(<span class="c-code__stringliteral">&quot;Finished adding &#39;{0}&#39; sources&quot;</span>, ips.Count);</div><div class="c-code__line">        }</div><div class="c-code__line"></div><div class="c-code__line">        <span class="c-code__keyword">private</span> <span class="c-code__keyword">static</span> <span class="c-code__keywordtype">void</span> LogProgress(</div><div class="c-code__line">            ILogger logger,</div><div class="c-code__line">            BlockingCollection&lt;Truth&gt; truth, </div><div class="c-code__line">            Consumer[] consumers,</div><div class="c-code__line">            Process process, </div><div class="c-code__line">            <span class="c-code__keywordtype">int</span> added, </div><div class="c-code__line">            ref DateTime lastLog, </div><div class="c-code__line">            ref DateTime nextLog,</div><div class="c-code__line">            ref TimeSpan lastProcessorTime,</div><div class="c-code__line">            Truth item)</div><div class="c-code__line">        {</div><div class="c-code__line">            <span class="c-code__keywordflow">if</span> (DateTime.UtcNow &gt;= nextLog)</div><div class="c-code__line">            {</div><div class="c-code__line">                <span class="c-code__comment">// Log the ranges and other telemetry.</span></div><div class="c-code__line">                logger.LogInformation(</div><div class="c-code__line">                    <span class="c-code__stringliteral">&quot;Processed &#39;{0}&#39; source records with &#39;{1}&#39; in &quot;</span> +</div><div class="c-code__line">                    <span class="c-code__stringliteral">&quot;queue, most recent &#39;{2:N2},{3:N2}&#39;, and &#39;{4}&#39; &quot;</span> +</div><div class="c-code__line">                    <span class="c-code__stringliteral">&quot;consumers&quot;</span>,</div><div class="c-code__line">                    added,</div><div class="c-code__line">                    truth.Count,</div><div class="c-code__line">                    item.Latitude,</div><div class="c-code__line">                    item.Longitude,</div><div class="c-code__line">                    consumers.Count(i =&gt; i.Task.IsCompleted == <span class="c-code__keyword">false</span>));</div><div class="c-code__line"></div><div class="c-code__line">                <span class="c-code__comment">// Get the elapsed time since last logged.</span></div><div class="c-code__line">                var elapsed = DateTime.UtcNow - lastLog;</div><div class="c-code__line"></div><div class="c-code__line">                <span class="c-code__comment">// The amount of CPU used is the processor time</span></div><div class="c-code__line">                <span class="c-code__comment">// difference divided by the wall clock time</span></div><div class="c-code__line">                <span class="c-code__comment">// difference.</span></div><div class="c-code__line">                var cpu =</div><div class="c-code__line">                    (process.TotalProcessorTime - lastProcessorTime) /</div><div class="c-code__line">                    elapsed;</div><div class="c-code__line"></div><div class="c-code__line">                <span class="c-code__comment">// Work out the number of queries per second.</span></div><div class="c-code__line">                var total = consumers.Sum(i =&gt; i.Count);</div><div class="c-code__line">                var qps = total / elapsed.TotalSeconds;</div><div class="c-code__line"></div><div class="c-code__line">                <span class="c-code__comment">// Log the resource usage.</span></div><div class="c-code__line">                logger.LogInformation(</div><div class="c-code__line">                    <span class="c-code__stringliteral">&quot;&#39;{0:F2}&#39; processors used, &#39;{1:N0} qps, &quot;</span> +</div><div class="c-code__line">                    <span class="c-code__stringliteral">&quot;&#39;{2}&#39; threads, &#39;{3}&#39; handles, and &#39;{4:N0}MB&#39; &quot;</span> +</div><div class="c-code__line">                    <span class="c-code__stringliteral">&quot;memory used&quot;</span>,</div><div class="c-code__line">                    cpu,</div><div class="c-code__line">                    qps,</div><div class="c-code__line">                    process.Threads.Count,</div><div class="c-code__line">                    process.HandleCount,</div><div class="c-code__line">                    process.WorkingSet64 / 1000);</div><div class="c-code__line"></div><div class="c-code__line">                <span class="c-code__comment">// Reset the count of queries to IPI.</span></div><div class="c-code__line">                <span class="c-code__keywordflow">foreach</span> (var consumer <span class="c-code__keywordflow">in</span> consumers)</div><div class="c-code__line">                {</div><div class="c-code__line">                    consumer.Count = 0;</div><div class="c-code__line">                }</div><div class="c-code__line"></div><div class="c-code__line">                <span class="c-code__comment">// Reset the other logging parameters.</span></div><div class="c-code__line">                lastLog = DateTime.UtcNow;</div><div class="c-code__line">                nextLog = DateTime.UtcNow.Add(_logBuild);</div><div class="c-code__line">                lastProcessorTime = process.TotalProcessorTime;</div><div class="c-code__line">            }</div><div class="c-code__line">        }</div><div class="c-code__line"></div><div class="c-code__line">        <span class="c-code__keyword">private</span> <span class="c-code__keyword">static</span> IReadOnlyList&lt;Output&gt; ProcessTruth(</div><div class="c-code__line">            IPipeline pipeline,</div><div class="c-code__line">            BlockingCollection&lt;Truth&gt; source,</div><div class="c-code__line">            Consumer consumer,</div><div class="c-code__line">            CancellationToken stoppingToken)</div><div class="c-code__line">        {</div><div class="c-code__line">            var output = <span class="c-code__keyword">new</span> List&lt;Output&gt;();</div><div class="c-code__line">            <span class="c-code__keywordflow">while</span> (source.IsCompleted == <span class="c-code__keyword">false</span> &amp;&amp;</div><div class="c-code__line">                stoppingToken.IsCancellationRequested == <span class="c-code__keyword">false</span>)</div><div class="c-code__line">            {</div><div class="c-code__line">                <span class="c-code__keywordflow">try</span></div><div class="c-code__line">                {</div><div class="c-code__line">                    <span class="c-code__keywordflow">if</span> (source.TryTake(out var truth, -1, stoppingToken))</div><div class="c-code__line">                    {</div><div class="c-code__line">                        var result = ProcessTruth(pipeline, truth);</div><div class="c-code__line">                        <span class="c-code__keywordflow">if</span> (result != <span class="c-code__keyword">null</span>)</div><div class="c-code__line">                        {</div><div class="c-code__line">                            output.Add(<span class="c-code__keyword">new</span> <a class="code" href="class_program.html#adf4fe232dbc7930c5ff8d4966b2c48a0">Output</a>(truth, result));</div><div class="c-code__line">                        }</div><div class="c-code__line">                    }</div><div class="c-code__line">                }</div><div class="c-code__line">                <span class="c-code__keywordflow">catch</span> (OperationCanceledException)</div><div class="c-code__line">                {</div><div class="c-code__line">                    <span class="c-code__comment">// Do nothing and exit the consumer.</span></div><div class="c-code__line">                }</div><div class="c-code__line">            }</div><div class="c-code__line">            <span class="c-code__keywordflow">return</span> output;</div><div class="c-code__line">        }</div><div class="c-code__line"></div><div class="c-code__line">        <span class="c-code__keyword">private</span> <span class="c-code__keyword">static</span> Result ProcessTruth(IPipeline pipeline, Truth truth)</div><div class="c-code__line">        {</div><div class="c-code__line">            <span class="c-code__comment">// Get the data for the IP address.</span></div><div class="c-code__line">            <span class="c-code__keyword">using</span> var flowData = pipeline.CreateFlowData();</div><div class="c-code__line">            flowData.AddEvidence(<span class="c-code__stringliteral">&quot;query.client-ip&quot;</span>, truth.Ip);</div><div class="c-code__line">            flowData.Process();</div><div class="c-code__line">            var data = flowData.Get&lt;IIpIntelligenceData&gt;();</div><div class="c-code__line"></div><div class="c-code__line">            <span class="c-code__comment">// Set the address family of the source truth does not provide it.</span></div><div class="c-code__line">            <span class="c-code__keywordflow">if</span> (String.IsNullOrEmpty(truth.AddressFamily))</div><div class="c-code__line">            {</div><div class="c-code__line">                truth.AddressFamily = IPAddress.Parse(truth.Ip)</div><div class="c-code__line">                    .AddressFamily.ToString();</div><div class="c-code__line">            }</div><div class="c-code__line"></div><div class="c-code__line">            <span class="c-code__comment">// Get the truth and result as points.</span></div><div class="c-code__line">            var truthPoint = <span class="c-code__keyword">new</span> GeoCoordinate(</div><div class="c-code__line">                truth.Latitude, </div><div class="c-code__line">                truth.Longitude);</div><div class="c-code__line">            var resultPoint = <span class="c-code__keyword">new</span> GeoCoordinate(</div><div class="c-code__line">                GetValue(data.Latitude), </div><div class="c-code__line">                GetValue(data.Longitude));</div><div class="c-code__line"></div><div class="c-code__line">            <span class="c-code__comment">// Get the area result for the returned data and the true latitude</span></div><div class="c-code__line">            <span class="c-code__comment">// and longitude.</span></div><div class="c-code__line">            var area = <a name="_a23"></a><a class="code" href="class_calculations.html">Calculations</a>.<a name="a24"></a><a class="code" href="class_calculations.html#a893bfd8981a3cd36cd213706b1b5b561">GetAreas</a>(</div><div class="c-code__line">                GetValue(data.Areas), </div><div class="c-code__line">                truth.Latitude,</div><div class="c-code__line">                truth.Longitude);</div><div class="c-code__line"></div><div class="c-code__line">            <span class="c-code__comment">// Return the result including the latitude, longitude, and</span></div><div class="c-code__line">            <span class="c-code__comment">// distance in kilometers between the result and the truth.</span></div><div class="c-code__line">            <span class="c-code__keywordflow">return</span> <span class="c-code__keyword">new</span> Result()</div><div class="c-code__line">            {</div><div class="c-code__line">                Latitude = resultPoint.Latitude,</div><div class="c-code__line">                Longitude = resultPoint.Longitude,</div><div class="c-code__line">                Confidence = GetValue(data.LocationConfidence),</div><div class="c-code__line">                DistanceKms = truthPoint.GetDistanceTo(resultPoint) / 1000,</div><div class="c-code__line">                SquareKms = area.SquareKms,</div><div class="c-code__line">                Geometries = area.Geometries,</div><div class="c-code__line">                Contains = area.Contains</div><div class="c-code__line">            };</div><div class="c-code__line">        }</div><div class="c-code__line"></div><div class="c-code__line">        <span class="c-code__keyword">private</span> <span class="c-code__keyword">static</span> T GetValue&lt;T&gt;(</div><div class="c-code__line">            IAspectPropertyValue&lt;T&gt; </div><div class="c-code__line">            value)</div><div class="c-code__line">        {</div><div class="c-code__line">            <span class="c-code__keywordflow">if</span> (value.HasValue)</div><div class="c-code__line">            {</div><div class="c-code__line">                <span class="c-code__keywordflow">return</span> value.Value;</div><div class="c-code__line">            }</div><div class="c-code__line">            <span class="c-code__keywordflow">return</span> <span class="c-code__keywordflow">default</span>;</div><div class="c-code__line">        }</div><div class="c-code__line">    }</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__keyword">static</span> <span class="c-code__keywordtype">void</span> Main(<span class="c-code__keywordtype">string</span>[] args)</div><div class="c-code__line">    {</div><div class="c-code__line">        var configuration = <span class="c-code__keyword">new</span> Configuration</div><div class="c-code__line">        {</div><div class="c-code__line">            <span class="c-code__comment">// Use the supplied path for the data file or find the lite file that</span></div><div class="c-code__line">            <span class="c-code__comment">// is included in the repository.</span></div><div class="c-code__line">            DataFile = args.Length &gt; 0 ? args[0] :</div><div class="c-code__line">            <span class="c-code__comment">// In this example, by default, the 51Degrees IP Intelligence data</span></div><div class="c-code__line">            <span class="c-code__comment">// file needs to be somewhere in the project space, or you may</span></div><div class="c-code__line">            <span class="c-code__comment">// specify another file as a command line parameter.</span></div><div class="c-code__line">            <span class="c-code__comment">//</span></div><div class="c-code__line">            <span class="c-code__comment">// For testing, contact us to obtain an enterprise data file:</span></div><div class="c-code__line">            <span class="c-code__comment">// https://51degrees.com/contact-us</span></div><div class="c-code__line">                Examples.ExampleUtils.FindFile(</div><div class="c-code__line">                    Constants.ENTERPRISE_IPI_DATA_FILE_NAME),</div><div class="c-code__line"></div><div class="c-code__line">            <span class="c-code__comment">// Get the of the CSV file containing source truth.</span></div><div class="c-code__line">            CsvTruthFile = args.Length &gt; 1 </div><div class="c-code__line">            ? args[1] </div><div class="c-code__line">            : Examples.ExampleUtils.FindFile(</div><div class="c-code__line">                    Constants.GEOIP_COMPARISON_EVIDENCE_FILE_NAME),</div><div class="c-code__line">        };</div><div class="c-code__line"></div><div class="c-code__line">        <span class="c-code__comment">// Get the location for the output file. Use the same location as the</span></div><div class="c-code__line">        <span class="c-code__comment">// evidence if a path is not supplied on the command line.</span></div><div class="c-code__line">        var outputFile = args.Length &gt; 2 ? args[2] : <span class="c-code__stringliteral">&quot;compare-output.csv&quot;</span>;</div><div class="c-code__line"></div><div class="c-code__line">        File.WriteAllText(<span class="c-code__stringliteral">&quot;Metrics_DataFileName.txt&quot;</span>, configuration.DataFile);</div><div class="c-code__line"></div><div class="c-code__line">        <span class="c-code__comment">// Configure a logger to output to the console.</span></div><div class="c-code__line">        configuration.LoggerFactory = LoggerFactory.Create(b =&gt; b.AddConsole());</div><div class="c-code__line">        </div><div class="c-code__line">        <span class="c-code__keywordflow">if</span> (configuration.DataFile != <span class="c-code__keyword">null</span>)</div><div class="c-code__line">        {</div><div class="c-code__line">            <span class="c-code__keyword">using</span> var output = File.CreateText(outputFile);</div><div class="c-code__line">            configuration.Output = output;</div><div class="c-code__line">            var builder = Host.CreateApplicationBuilder([]);</div><div class="c-code__line">            builder.Services.AddSingleton(configuration);</div><div class="c-code__line">            builder.Services.AddHostedService&lt;<a class="code" href="class_program.html#a898dc758806b6d5937f2fd6382eebd91">Worker</a>&gt;();</div><div class="c-code__line">            <span class="c-code__keyword">using</span> var host = builder.Build();</div><div class="c-code__line">            host.Run();</div><div class="c-code__line">        }</div><div class="c-code__line">        <span class="c-code__keywordflow">else</span></div><div class="c-code__line">        {</div><div class="c-code__line">            var logger = configuration.LoggerFactory.CreateLogger&lt;<a class="code" href="class_program.html">Program</a>&gt;();</div><div class="c-code__line">            logger.LogError(<span class="c-code__stringliteral">&quot;Failed to find a IP Intelligence data file. &quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;Make sure the ip-intelligence-data submodule has been &quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;updated by running `git submodule update --recursive`. By &quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;default, the &#39;lite&#39; file included with this code will be &quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;used. A different file can be specified by supplying the &quot;</span> +</div><div class="c-code__line">                <span class="c-code__stringliteral">&quot;full path as a command line argument&quot;</span>);</div><div class="c-code__line">        }</div><div class="c-code__line"></div><div class="c-code__line">        <span class="c-code__comment">// Dispose the logger to ensure any messages get flushed</span></div><div class="c-code__line">        configuration.LoggerFactory.Dispose();</div><div class="c-code__line">    }</div><div class="c-code__line">}</div></div> </div><!-- primary -->
</div><!-- inner-->
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<section id="nav-path" class="g-footer g-footer--docs"><!-- id is needed for treeview function! -->
    <p class="g-footer__copyright">Generated by
    <a href="http://www.doxygen.org/index.html">
    <b>doxygen</b></a> 1.8.15
  </p>
</section>
</div>
</main>
</div>
</body>
</html>
